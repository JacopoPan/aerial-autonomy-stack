<% drone_type = ENV.fetch('DRONE_TYPE', 'quad') %>
<% autopilot = ENV.fetch('AUTOPILOT', 'px4') %>
<% drone_id = ENV.fetch('DRONE_ID', 1).to_i %>

name: aircraft_tmuxinator

windows:

  <% if autopilot == 'px4' %>
  - px4_aircraft_<%= drone_id %>:
      layout: even-horizontal
      panes:
        - MicroXRCEAgent udp4 -p 8888

  <% elsif autopilot == 'ardupilot' %>
  - ardupilot_aircraft_<%= drone_id %>:
      layout: even-horizontal
      panes:
        - /git/MAVSDK/build/src/mavsdk_server/src/mavsdk_server udpin://0.0.0.0:14550
  <% end %>

  - yolo:
      layout: even-horizontal
      panes:
        - /yolo-env/bin/python3 /git/resources/yolo/yolo-inference.py
        - gst-launch-1.0 udpsrc port=5600 ! application/x-rtp, media=video, encoding-name=H264 ! rtph264depay ! avdec_h264 ! videoconvert ! autovideosink

  - housekeeping:
      layout: even-horizontal
      panes:
        - # Interactive pane
        - htop
